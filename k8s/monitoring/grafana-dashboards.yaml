# Generated via: kubectl create configmap grafana-dashboards --from-file=dashboards/ -n monitoring --dry-run=client -o yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards
  namespace: monitoring
data:
  afrimart-application.json: |
    {"annotations":{"list":[]},"editable":true,"id":null,"panels":[{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"reqps"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":0},"targets":[{"expr":"sum(rate(http_requests_total{job=\"afrimart-backend\"}[5m])) by (method, route)","legendFormat":"{{method}} {{route}}","refId":"A"}],"title":"Request Rate","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"s"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":0},"targets":[{"expr":"histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{job=\"afrimart-backend\"}[5m])) by (le, route))","legendFormat":"p95 {{route}}","refId":"A"}],"title":"Request Latency (p95)","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":8},"targets":[{"expr":"sum(rate(http_requests_total{job=\"afrimart-backend\",status_code=~\"5..\"}[5m])) by (status_code)","legendFormat":"{{status_code}}","refId":"A"}],"title":"Error Rate (5xx)","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":8},"targets":[{"expr":"active_connections{job=\"afrimart-backend\"}","legendFormat":"Active Connections","refId":"A"}],"title":"Active Connections","type":"timeseries"}],"schemaVersion":38,"tags":["afrimart","application"],"templating":{"list":[{"current":{},"hide":0,"name":"datasource","type":"datasource"}]},"time":{"from":"now-1h","to":"now"},"title":"AfriMart Application Metrics","version":1}
  afrimart-overview.json: |
    {"annotations":{"list":[]},"editable":true,"id":null,"panels":[{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"}},"overrides":[]},"gridPos":{"h":4,"w":6,"x":0,"y":0},"targets":[{"expr":"up{job=\"afrimart-backend\"}","refId":"A"}],"title":"Backend Status","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"unit":"reqps"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":6,"y":0},"targets":[{"expr":"sum(rate(http_requests_total{job=\"afrimart-backend\"}[5m]))","refId":"A"}],"title":"Request Rate","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"unit":"s"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":12,"y":0},"targets":[{"expr":"histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{job=\"afrimart-backend\"}[5m])) by (le))","refId":"A"}],"title":"Latency p95","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"}},"overrides":[]},"gridPos":{"h":4,"w":6,"x":18,"y":0},"targets":[{"expr":"(sum(rate(http_requests_total{job=\"afrimart-backend\",status_code=~\"5..\"}[5m])) / sum(rate(http_requests_total{job=\"afrimart-backend\"}[5m]))) * 100","refId":"A"}],"title":"Error %","type":"stat"}],"schemaVersion":38,"tags":["afrimart","overview"],"templating":{"list":[{"current":{},"hide":0,"name":"datasource","type":"datasource"}]},"time":{"from":"now-1h","to":"now"},"title":"AfriMart Overview","version":1}
  infrastructure.json: |
    {"annotations":{"list":[]},"editable":true,"id":null,"panels":[{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":0},"targets":[{"expr":"100 - (avg by(instance) (rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)","legendFormat":"{{instance}}","refId":"A"}],"title":"CPU Usage","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":0},"targets":[{"expr":"(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100","legendFormat":"{{instance}}","refId":"A"}],"title":"Memory Usage","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"bytes"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":8},"targets":[{"expr":"node_filesystem_avail_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"}","legendFormat":"{{instance}}","refId":"A"}],"title":"Disk Available","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":8},"targets":[{"expr":"up","legendFormat":"{{job}} ({{instance}})","refId":"A"}],"title":"Targets Up","type":"stat"}],"schemaVersion":38,"tags":["infrastructure"],"templating":{"list":[{"current":{},"hide":0,"name":"datasource","type":"datasource"}]},"time":{"from":"now-1h","to":"now"},"title":"Infrastructure (CPU, Memory, Disk)","version":1}
  database-performance.json: |
    {"annotations":{"list":[]},"editable":true,"id":null,"panels":[{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":0},"targets":[{"expr":"pg_stat_database_numbackends","legendFormat":"{{datname}}","refId":"A"}],"title":"Active Connections","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":0},"targets":[{"expr":"pg_stat_database_xact_commit","legendFormat":"commits {{datname}}","refId":"A"}],"title":"Transactions Committed","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":8},"targets":[{"expr":"pg_stat_database_xact_rollback","legendFormat":"rollbacks {{datname}}","refId":"A"}],"title":"Transactions Rolled Back","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":8},"targets":[{"expr":"rate(pg_stat_database_tup_fetched[5m])","legendFormat":"fetched {{datname}}","refId":"A"}],"title":"Rows Fetched (rate)","type":"timeseries"}],"schemaVersion":38,"tags":["database","postgres"],"templating":{"list":[{"current":{},"hide":0,"name":"datasource","type":"datasource"}]},"time":{"from":"now-1h","to":"now"},"title":"Database Performance (PostgreSQL)","version":1}
  redis-cache.json: |
    {"annotations":{"list":[]},"editable":true,"id":null,"panels":[{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":0},"targets":[{"expr":"redis_connected_clients","legendFormat":"Connected Clients","refId":"A"}],"title":"Connected Clients","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"bytes"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":0},"targets":[{"expr":"redis_memory_used_bytes","legendFormat":"Memory Used","refId":"A"}],"title":"Memory Used","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":8},"targets":[{"expr":"redis_commands_processed_total","legendFormat":"Commands","refId":"A"}],"title":"Commands Processed","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":8},"targets":[{"expr":"redis_keyspace_keys_total","legendFormat":"{{db}}","refId":"A"}],"title":"Keys per Database","type":"timeseries"}],"schemaVersion":38,"tags":["redis","cache"],"templating":{"list":[{"current":{},"hide":0,"name":"datasource","type":"datasource"}]},"time":{"from":"now-1h","to":"now"},"title":"Redis Cache Statistics","version":1}
  business-metrics.json: |
    {"annotations":{"list":[]},"editable":true,"id":null,"panels":[{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"unit":"short"},"overrides":[]},"gridPos":{"h":6,"w":8,"x":0,"y":0},"targets":[{"expr":"afrimart_orders_total","legendFormat":"Orders","refId":"A"}],"title":"Total Orders","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"unit":"currencyUSD"},"overrides":[]},"gridPos":{"h":6,"w":8,"x":8,"y":0},"targets":[{"expr":"afrimart_revenue_total","legendFormat":"Revenue","refId":"A"}],"title":"Total Revenue","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":6},"targets":[{"expr":"increase(afrimart_orders_total[1h])","legendFormat":"Orders (1h)","refId":"A"}],"title":"Orders per Hour","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"unit":"currencyUSD"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":6},"targets":[{"expr":"increase(afrimart_revenue_total[1h])","legendFormat":"Revenue (1h)","refId":"A"}],"title":"Revenue per Hour","type":"timeseries"}],"schemaVersion":38,"tags":["business","afrimart"],"templating":{"list":[{"current":{},"hide":0,"name":"datasource","type":"datasource"}]},"time":{"from":"now-1h","to":"now"},"title":"Business Metrics (Orders, Revenue)","version":1}
